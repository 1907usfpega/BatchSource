
--Scalar functions
SELECT Upper(NAME) FROM ARTIST;

--Aggregate functions
SELECT AVG(UNITPRICE) FROM TRACK;

--cOMPLETE QUERY
SELECT COUNT(EMPLOYEEID), CITY, COUNTRY FROM EMPLOYEE GROUP BY COUNTRY, CITY HAVING COUNT(EMPLOYEEID) > 1;

--JOINS STUFF
CREATE TABLE STUDENT(
S_ID NUMBER,
S_NAME VARCHAR2(20),
SCH_ID NUMBER);

CREATE TABLE SCHOOL(
SCH_ID NUMBER,
SCH_NAME VARCHAR2(20)
);

INSERT INTO SCHOOL VALUES (1, 'USF');
INSERT INTO SCHOOL VALUES (2, 'FSU');
INSERT INTO SCHOOL VALUES (3, 'UA');
INSERT INTO SCHOOL VALUES (4, 'UGA');
INSERT INTO SCHOOL VALUES (5, 'LSU');
INSERT INTO SCHOOL VALUES (6, 'AU');

INSERT INTO STUDENT VALUES (1, 'Matt', 3);
INSERT INTO STUDENT VALUES (2, 'Ben', 5);
INSERT INTO STUDENT VALUES (3, 'Han', 1);
INSERT INTO STUDENT VALUES (4, 'Ken', 5);
INSERT INTO STUDENT VALUES (5, 'Jackson', 4);
INSERT INTO STUDENT VALUES (6, 'John', 2);
INSERT INTO STUDENT VALUES (7, 'Levi', 1);
INSERT INTO STUDENT VALUES (8, 'Andrew', 3);
INSERT INTO STUDENT VALUES (9, 'Brad', 2);
INSERT INTO STUDENT VALUES (10, 'Ren', 5);

SELECT * FROM SCHOOL RIGHT JOIN STUDENT ON SCHOOL.SCH_ID = STUDENT.SCH_ID ORDER BY STUDENT.S_NAME;

CREATE TABLE STUDENT2(
ID NUMBER,
NAME VARCHAR(20),
LAB_PARTNER NUMBER
);

INSERT INTO STUDENT2 VALUES (1, 'Matt', 6);
INSERT INTO STUDENT2 VALUES (2, 'Ben', 5);
INSERT INTO STUDENT2 VALUES (3, 'Ren', 4);
INSERT INTO STUDENT2 VALUES (4, 'Han', 3);
INSERT INTO STUDENT2 VALUES (5, 'Ken', 2);
INSERT INTO STUDENT2 VALUES (6, 'Levi', 1);

--SELF JOIN
SELECT A.NAME AS STUDENT, B.NAME AS LAB_PARTNER FROM STUDENT2 A JOIN STUDENT2 B ON A.LAB_PARTNER = B.ID;

--ROCK SONG, 300,000 MS, MPEG FILE, ARTIST
SELECT ARTIST.NAME, TRACK.TRACKID, TRACK.NAME FROM TRACK JOIN ALBUM ON TRACK.ALBUMID = ALBUM.ALBUMID JOIN ARTIST ON ALBUM.ARTISTID = ARTIST.ARTISTID WHERE TRACK.GENREID = 1 AND TRACK.Milliseconds > 300000 AND TRACK.MEDIATYPEID = 1;


SELECT FIRSTNAME, LASTNAME FROM EMPLOYEE WHERE EXTRACT(YEAR FROM TO_DATE(BIRTHDATE)) > 68;
/*4.1*/
CREATE PROCEDURE Emp.GetNames AS
SELECT EMPLOYEE.FIRSTNAME, EMPLOYEE.LASTNAME FROM EMPLOYEE
GO

EXEC Emp.GetNames;